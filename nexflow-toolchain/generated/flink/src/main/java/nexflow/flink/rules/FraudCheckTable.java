/**
 * Decision Table: fraud_check
 *
 * Auto-generated by Nexflow L4 Rules Generator.
 * DO NOT EDIT - Changes will be overwritten.
 */
package nexflow.flink.rules;

import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import java.util.Set;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import static nexflow.flink.runtime.NexflowRuntime.*;

public class FraudCheckTable {

    private static final Logger LOG = LoggerFactory.getLogger(FraudCheckTable.class);

    /**
     * Evaluate decision table: fraud_check
     * Hit Policy: FIRST_MATCH - returns first matching row's result
     */
    public Optional<String> evaluate(FraudCheckTableInput input) {
        if (matchRow1(input)) {
            return Optional.of(getRow1Result(input));
        }
        if (matchRow2(input)) {
            return Optional.of(getRow2Result(input));
        }
        if (matchRow3(input)) {
            return Optional.of(getRow3Result(input));
        }
        if (matchRow4(input)) {
            return Optional.of(getRow4Result(input));
        }
        if (matchRow5(input)) {
            return Optional.of(getRow5Result(input));
        }
        if (matchRow6(input)) {
            return Optional.of(getRow6Result(input));
        }
        if (matchRow7(input)) {
            return Optional.of(getRow7Result(input));
        }
        if (matchRow8(input)) {
            return Optional.of(getRow8Result(input));
        }
        // No matching rule
        return Optional.empty();
    }

    private boolean matchRow1(FraudCheckTableInput input) {
        return ((input.getAmount() != null && input.getAmount().compareTo(new BigDecimal("50000")) > 0)) && ("high".equals(input.getRiskTier())) && (true) && (true);
    }

    private String getRow1Result(FraudCheckTableInput input) {
        return "block";
    }

    private boolean matchRow2(FraudCheckTableInput input) {
        return ((input.getAmount() != null && input.getAmount().compareTo(new BigDecimal("25000")) > 0)) && ("high".equals(input.getRiskTier())) && ((input.getVelocity24h() > 10L)) && (true);
    }

    private String getRow2Result(FraudCheckTableInput input) {
        return "block";
    }

    private boolean matchRow3(FraudCheckTableInput input) {
        return ((input.getAmount() != null && input.getAmount().compareTo(new BigDecimal("10000")) > 0)) && (true) && ((input.getVelocity24h() > 20L)) && (true);
    }

    private String getRow3Result(FraudCheckTableInput input) {
        return "review";
    }

    private boolean matchRow4(FraudCheckTableInput input) {
        return (true) && ("high".equals(input.getRiskTier())) && (true) && ((input.getFraudProbability() != null && input.getFraudProbability().compareTo(new BigDecimal("0.8")) > 0));
    }

    private String getRow4Result(FraudCheckTableInput input) {
        return "block";
    }

    private boolean matchRow5(FraudCheckTableInput input) {
        return (true) && ("medium".equals(input.getRiskTier())) && (true) && ((input.getFraudProbability() != null && input.getFraudProbability().compareTo(new BigDecimal("0.7")) > 0));
    }

    private String getRow5Result(FraudCheckTableInput input) {
        return "review";
    }

    private boolean matchRow6(FraudCheckTableInput input) {
        return ((input.getAmount() != null && input.getAmount().compareTo(new BigDecimal("5000")) > 0)) && (true) && (true) && ((input.getFraudProbability() != null && input.getFraudProbability().compareTo(new BigDecimal("0.6")) > 0));
    }

    private String getRow6Result(FraudCheckTableInput input) {
        return "review";
    }

    private boolean matchRow7(FraudCheckTableInput input) {
        return ((input.getAmount() != null && input.getAmount().compareTo(new BigDecimal("100")) < 0)) && ("low".equals(input.getRiskTier())) && ((input.getVelocity24h() < 5L)) && ((input.getFraudProbability() != null && input.getFraudProbability().compareTo(new BigDecimal("0.3")) < 0));
    }

    private String getRow7Result(FraudCheckTableInput input) {
        return "approve";
    }

    private boolean matchRow8(FraudCheckTableInput input) {
        return (true) && (true) && (true) && (true);
    }

    private String getRow8Result(FraudCheckTableInput input) {
        return "manual";
    }


    /**
     * Input data class for fraud_check
     */
    public static class FraudCheckTableInput {
        private BigDecimal amount;
        private String riskTier;
        private Long velocity24h;
        private Long accountAge;
        private Long fraudProbability;

        public BigDecimal getAmount() { return amount; }
        public void setAmount(BigDecimal amount) { this.amount = amount; }
        public String getRiskTier() { return riskTier; }
        public void setRiskTier(String riskTier) { this.riskTier = riskTier; }
        public Long getVelocity24h() { return velocity24h; }
        public void setVelocity24h(Long velocity24h) { this.velocity24h = velocity24h; }
        public Long getAccountAge() { return accountAge; }
        public void setAccountAge(Long accountAge) { this.accountAge = accountAge; }
        public Long getFraudProbability() { return fraudProbability; }
        public void setFraudProbability(Long fraudProbability) { this.fraudProbability = fraudProbability; }
    }

}