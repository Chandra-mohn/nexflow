/**
 * DoubleAmountFunction
 *
 * MapFunction for double_amount
 *
 * AUTO-GENERATED by Nexflow Code Generator
 * DO NOT EDIT - Changes will be overwritten
 *
 * Generator: TransformGenerator
 */

package nexflow.flink.transform;

import java.math.BigDecimal;
import java.time.Instant;
import java.time.LocalDate;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
import java.util.Objects;
import java.util.Optional;

import org.apache.flink.api.common.functions.MapFunction;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;


public class DoubleAmountFunction implements MapFunction<Map<String, Object>, Map<String, Object>> {

    private static final Logger LOG = LoggerFactory.getLogger(DoubleAmountFunction.class);
    // Pure function - no side effects

    @Override
    public Map<String, Object> map(Map<String, Object> input) throws Exception {
        return transform(input);
    }

    /**
     * Transform: double_amount
     * Doubles the input amount
     */
    public Map<String, Object> transform(Map<String, Object> input) throws Exception {
        Map<String, Object> result = new HashMap<>();

        // Apply transformation logic
        result.put("result", (((Number)input.get("amount")).doubleValue() * 2d));

        return result;
    }

}