/**
 * EnrichedTransaction
 *
 * POJO for enriched_transaction schema
 *
 * AUTO-GENERATED by Nexflow Code Generator
 * DO NOT EDIT - Changes will be overwritten
 *
 * Generator: SchemaGenerator
 */

package nexflow.flink.schema;

import java.io.Serializable;
import java.math.BigDecimal;
import java.time.Instant;
import java.util.UUID;


public class EnrichedTransaction implements Serializable {

    private static final long serialVersionUID = 1L;

        private UUID transactionId;
        private String customerId;
        private BigDecimal amount;
        private BigDecimal normalizedAmount;
        private String merchantId;
        private String riskTier;
        private BigDecimal creditLimit;
        private Long accountAge;
        private Long velocity24h;
        private BigDecimal fraudProbability;
        private Instant eventTimestamp;
        private Instant processingTimestamp;

    public EnrichedTransaction() {
        // Default constructor
    }

    public UUID getTransactionId() {
        return this.transactionId;
    }

    public void setTransactionId(UUID transactionId) {
        this.transactionId = transactionId;
    }

    public String getCustomerId() {
        return this.customerId;
    }

    public void setCustomerId(String customerId) {
        this.customerId = customerId;
    }

    public BigDecimal getAmount() {
        return this.amount;
    }

    public void setAmount(BigDecimal amount) {
        this.amount = amount;
    }

    public BigDecimal getNormalizedAmount() {
        return this.normalizedAmount;
    }

    public void setNormalizedAmount(BigDecimal normalizedAmount) {
        this.normalizedAmount = normalizedAmount;
    }

    public String getMerchantId() {
        return this.merchantId;
    }

    public void setMerchantId(String merchantId) {
        this.merchantId = merchantId;
    }

    public String getRiskTier() {
        return this.riskTier;
    }

    public void setRiskTier(String riskTier) {
        this.riskTier = riskTier;
    }

    public BigDecimal getCreditLimit() {
        return this.creditLimit;
    }

    public void setCreditLimit(BigDecimal creditLimit) {
        this.creditLimit = creditLimit;
    }

    public Long getAccountAge() {
        return this.accountAge;
    }

    public void setAccountAge(Long accountAge) {
        this.accountAge = accountAge;
    }

    public Long getVelocity24h() {
        return this.velocity24h;
    }

    public void setVelocity24h(Long velocity24h) {
        this.velocity24h = velocity24h;
    }

    public BigDecimal getFraudProbability() {
        return this.fraudProbability;
    }

    public void setFraudProbability(BigDecimal fraudProbability) {
        this.fraudProbability = fraudProbability;
    }

    public Instant getEventTimestamp() {
        return this.eventTimestamp;
    }

    public void setEventTimestamp(Instant eventTimestamp) {
        this.eventTimestamp = eventTimestamp;
    }

    public Instant getProcessingTimestamp() {
        return this.processingTimestamp;
    }

    public void setProcessingTimestamp(Instant processingTimestamp) {
        this.processingTimestamp = processingTimestamp;
    }

    /**
     * Generate correlation key from specified fields.
     * Used by Flink keying operations for event correlation.
     *
     * @param fields Array of field names to include in the key
     * @return Concatenated string key from field values
     */
    public String getCorrelationKey(String[] fields) {
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < fields.length; i++) {
            if (i > 0) sb.append(":");
            switch (fields[i]) {
                case "transaction_id":
                    sb.append(getTransactionId());
                    break;
                case "customer_id":
                    sb.append(getCustomerId());
                    break;
                case "amount":
                    sb.append(getAmount());
                    break;
                case "normalized_amount":
                    sb.append(getNormalizedAmount());
                    break;
                case "merchant_id":
                    sb.append(getMerchantId());
                    break;
                case "risk_tier":
                    sb.append(getRiskTier());
                    break;
                case "credit_limit":
                    sb.append(getCreditLimit());
                    break;
                case "account_age":
                    sb.append(getAccountAge());
                    break;
                case "velocity_24h":
                    sb.append(getVelocity24h());
                    break;
                case "fraud_probability":
                    sb.append(getFraudProbability());
                    break;
                case "event_timestamp":
                    sb.append(getEventTimestamp());
                    break;
                case "processing_timestamp":
                    sb.append(getProcessingTimestamp());
                    break;
                default:
                    sb.append("null");
            }
        }
        return sb.toString();
    }

    /**
     * Alias for getCorrelationKey - used by hold patterns for buffer keying.
     */
    public String getBufferKey(String[] fields) {
        return getCorrelationKey(fields);
    }

    /**
     * Get simple key for this record (first identity field or fallback).
     * Used by window operations and RoutedEvent compatibility.
     */
    public String getKey() {
        // Return first non-null identity field as default key
        Object val = getTransactionId();
        return val != null ? val.toString() : "null";
    }

    @Override
    public String toString() {
        return "EnrichedTransaction{" +
                "transactionId=" + transactionId +
                ", customerId=" + customerId +
                ", amount=" + amount +
                ", normalizedAmount=" + normalizedAmount +
                ", merchantId=" + merchantId +
                ", riskTier=" + riskTier +
                ", creditLimit=" + creditLimit +
                ", accountAge=" + accountAge +
                ", velocity24h=" + velocity24h +
                ", fraudProbability=" + fraudProbability +
                ", eventTimestamp=" + eventTimestamp +
                ", processingTimestamp=" + processingTimestamp +
                "}";
    }
}
