/**
 * Procedural Rule: categorize_merchant
 *
 * Auto-generated by Nexflow L4 Rules Generator.
 * DO NOT EDIT - Changes will be overwritten.
 */
package nexflow.flink.rules;

import java.math.BigDecimal;
import java.util.Arrays;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class CategorizeMerchantRule {

    private static final Logger LOG = LoggerFactory.getLogger(CategorizeMerchantRule.class);

    /**
     * Execute rule: categorize_merchant
     */
    public void execute(Object context) {
        if (((merchantId() != null))) {
            extractMcc(merchantId());
            if ((Arrays.asList("5411", "5412", "5499").contains(mcc()))) {
                setCategory("grocery");
            } else if ((Arrays.asList("5812", "5813", "5814").contains(mcc()))) {
                setCategory("restaurant");
            } else if ((Arrays.asList("5541", "5542").contains(mcc()))) {
                setCategory("gas_station");
            } else if ((Arrays.asList("5311", "5331", "5399").contains(mcc()))) {
                setCategory("retail");
            } else if ((Arrays.asList("4111", "4112", "4121").contains(mcc()))) {
                setCategory("transportation");
            } else if ((Arrays.asList("7011", "7012").contains(mcc()))) {
                setCategory("lodging");
            } else if ((Arrays.asList("4511", "4582").contains(mcc()))) {
                setCategory("airline");
            } else {
                setCategory("other");
            }
            if (((category() == "other") && ((avgTransaction() > 500L)))) {
                setRisk("high");
            } else if (((transactionCount() < 10L) && ((avgTransaction() > 1000L)))) {
                setRisk("high");
            } else if ((Arrays.asList("grocery", "gas_station").contains(category()))) {
                setRisk("low");
            } else {
                setRisk("medium");
            }
        }
        return;
    }

    // =========================================================================
    // Action Method Stubs - Implement these methods for rule execution
    // =========================================================================

    /**
     * Action: extract_mcc
     * TODO: Implement this action method.
     */
    protected void extractMcc(Object arg0) {
        throw new UnsupportedOperationException("Action extract_mcc not implemented");
    }

    /**
     * Action: set_category
     * TODO: Implement this action method.
     */
    protected void setCategory(Object arg0) {
        throw new UnsupportedOperationException("Action set_category not implemented");
    }

    /**
     * Action: set_risk
     * TODO: Implement this action method.
     */
    protected void setRisk(Object arg0) {
        throw new UnsupportedOperationException("Action set_risk not implemented");
    }


}