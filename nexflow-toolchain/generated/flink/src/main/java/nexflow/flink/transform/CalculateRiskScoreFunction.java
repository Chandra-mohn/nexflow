/**
 * CalculateRiskScoreFunction
 *
 * MapFunction for calculate_risk_score
 *
 * AUTO-GENERATED by Nexflow Code Generator
 * DO NOT EDIT - Changes will be overwritten
 *
 * Generator: TransformGenerator
 */

package nexflow.flink.transform;

import java.math.BigDecimal;
import java.time.Instant;
import java.time.LocalDate;
import java.util.Arrays;
import java.util.Objects;
import java.util.Optional;

import org.apache.flink.api.common.functions.MapFunction;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;


public class CalculateRiskScoreFunction implements MapFunction<Object, Object> {

    private static final Logger LOG = LoggerFactory.getLogger(CalculateRiskScoreFunction.class);
    // Pure function - no side effects

    @Override
    public Object map(Object value) throws Exception {
        return transform(value);
    }

    /**
     * Transform: calculate_risk_score
     * Calculates transaction risk score
     */
    public Object transform(Object input) throws Exception {
        Object result = new Object();

        // Apply transformation logic
        result.setBaseScore(((getAmount() > 10000L)) ? new BigDecimal("0.4") : ((getAmount() > 5000L)) ? new BigDecimal("0.2") : ((getAmount() > 1000L)) ? new BigDecimal("0.1") : new BigDecimal("0.05"));
        result.setVelocityFactor(((getVelocity24h() > 20L)) ? new BigDecimal("0.3") : ((getVelocity24h() > 10L)) ? new BigDecimal("0.15") : ((getVelocity24h() > 5L)) ? new BigDecimal("0.05") : new BigDecimal("0.0"));
        result.setAgeFactor(((getAccountAge() < 30L)) ? new BigDecimal("0.2") : ((getAccountAge() < 90L)) ? new BigDecimal("0.1") : ((getAccountAge() < 365L)) ? new BigDecimal("0.05") : new BigDecimal("0.0"));
        result.setTierFactor(((getRiskTier() == "high")) ? new BigDecimal("0.25") : ((getRiskTier() == "medium")) ? new BigDecimal("0.1") : new BigDecimal("0.0"));
        result.setRiskScore(Math.min((((getBaseScore() + getVelocityFactor()) + getAgeFactor()) + getTierFactor()), new BigDecimal("1.0")));

        return result;
    }

}