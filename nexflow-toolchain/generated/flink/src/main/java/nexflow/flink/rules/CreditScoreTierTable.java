/**
 * Decision Table: credit_score_tier
 *
 * Auto-generated by Nexflow L4 Rules Generator.
 * DO NOT EDIT - Changes will be overwritten.
 */
package nexflow.flink.rules;

import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import java.util.Set;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class CreditScoreTierTable {

    private static final Logger LOG = LoggerFactory.getLogger(CreditScoreTierTable.class);

    /**
     * Evaluate decision table: credit_score_tier
     * Hit Policy: FIRST_MATCH - returns first matching row's result
     */
    public Optional<String> evaluate(CreditScoreTierTableInput input) {
        if (matchRow1(input)) {
            return Optional.of(getRow1Result(input));
        }
        if (matchRow2(input)) {
            return Optional.of(getRow2Result(input));
        }
        if (matchRow3(input)) {
            return Optional.of(getRow3Result(input));
        }
        if (matchRow4(input)) {
            return Optional.of(getRow4Result(input));
        }
        if (matchRow5(input)) {
            return Optional.of(getRow5Result(input));
        }
        // No matching rule
        return Optional.empty();
    }

    private boolean matchRow1(CreditScoreTierTableInput input) {
        return ((input.getCreditScore() != null && input.getCreditScore().compareTo(750L) >= 0 && input.getCreditScore().compareTo(850L) <= 0));
    }

    private String getRow1Result(CreditScoreTierTableInput input) {
        return "low";
    }

    private boolean matchRow2(CreditScoreTierTableInput input) {
        return ((input.getCreditScore() != null && input.getCreditScore().compareTo(700L) >= 0 && input.getCreditScore().compareTo(749L) <= 0));
    }

    private String getRow2Result(CreditScoreTierTableInput input) {
        return "medium";
    }

    private boolean matchRow3(CreditScoreTierTableInput input) {
        return ((input.getCreditScore() != null && input.getCreditScore().compareTo(650L) >= 0 && input.getCreditScore().compareTo(699L) <= 0));
    }

    private String getRow3Result(CreditScoreTierTableInput input) {
        return "elevated";
    }

    private boolean matchRow4(CreditScoreTierTableInput input) {
        return ((input.getCreditScore() != null && input.getCreditScore().compareTo(600L) >= 0 && input.getCreditScore().compareTo(649L) <= 0));
    }

    private String getRow4Result(CreditScoreTierTableInput input) {
        return "high";
    }

    private boolean matchRow5(CreditScoreTierTableInput input) {
        return ((input.getCreditScore() < 600L));
    }

    private String getRow5Result(CreditScoreTierTableInput input) {
        return "critical";
    }


    /**
     * Input data class for credit_score_tier
     */
    public static class CreditScoreTierTableInput {
        private Long creditScore;

        public Long getCreditScore() { return creditScore; }
        public void setCreditScore(Long creditScore) { this.creditScore = creditScore; }
    }

}