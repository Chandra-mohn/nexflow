/**
 * Decision Table: velocity_alert
 *
 * Auto-generated by Nexflow L4 Rules Generator.
 * DO NOT EDIT - Changes will be overwritten.
 */
package nexflow.flink.rules;

import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import java.util.Set;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import static nexflow.flink.runtime.NexflowRuntime.*;

public class VelocityAlertTable {

    private static final Logger LOG = LoggerFactory.getLogger(VelocityAlertTable.class);

    /**
     * Evaluate decision table: velocity_alert
     * Hit Policy: MULTI_HIT - returns all matching rows' results
     */
    public List<String> evaluate(VelocityAlertTableInput input) {
        List<String> results = new ArrayList<>();

        if (matchRow1(input)) {
            results.add(getRow1Result(input));
        }
        if (matchRow2(input)) {
            results.add(getRow2Result(input));
        }
        if (matchRow3(input)) {
            results.add(getRow3Result(input));
        }
        if (matchRow4(input)) {
            results.add(getRow4Result(input));
        }

        return results;
    }

    private boolean matchRow1(VelocityAlertTableInput input) {
        return ((input.getVelocity1h() > 10L)) && (true) && (true);
    }

    private String getRow1Result(VelocityAlertTableInput input) {
        return null;
    }

    private boolean matchRow2(VelocityAlertTableInput input) {
        return (true) && ((input.getVelocity24h() > 50L)) && (true);
    }

    private String getRow2Result(VelocityAlertTableInput input) {
        return null;
    }

    private boolean matchRow3(VelocityAlertTableInput input) {
        return (true) && (true) && ((input.getCurrentAmount() != null && input.getCurrentAmount().compareTo(new BigDecimal("5000")) > 0));
    }

    private String getRow3Result(VelocityAlertTableInput input) {
        return null;
    }

    private boolean matchRow4(VelocityAlertTableInput input) {
        return ((input.getVelocity1h() > 5L)) && ((input.getVelocity24h() > 30L)) && ((input.getCurrentAmount() != null && input.getCurrentAmount().compareTo(new BigDecimal("3000")) > 0));
    }

    private String getRow4Result(VelocityAlertTableInput input) {
        return null;
    }


    /**
     * Input data class for velocity_alert
     */
    public static class VelocityAlertTableInput {
        private Long velocity1h;
        private Long velocity24h;
        private BigDecimal avgAmount;
        private BigDecimal currentAmount;

        public Long getVelocity1h() { return velocity1h; }
        public void setVelocity1h(Long velocity1h) { this.velocity1h = velocity1h; }
        public Long getVelocity24h() { return velocity24h; }
        public void setVelocity24h(Long velocity24h) { this.velocity24h = velocity24h; }
        public BigDecimal getAvgAmount() { return avgAmount; }
        public void setAvgAmount(BigDecimal avgAmount) { this.avgAmount = avgAmount; }
        public BigDecimal getCurrentAmount() { return currentAmount; }
        public void setCurrentAmount(BigDecimal currentAmount) { this.currentAmount = currentAmount; }
    }

}