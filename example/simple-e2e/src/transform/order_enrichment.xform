// Order Enrichment Transform
// Calculates total and adds processing timestamp

transform enrich_order
    input: order
    output: enriched_order

    apply
        order_id = input.order_id
        customer_id = input.customer_id
        product = input.product
        quantity = input.quantity
        price = input.price
        total = input.quantity * input.price
        status = "processed"
        created_at = input.created_at
        processed_at = now()
    end
end
